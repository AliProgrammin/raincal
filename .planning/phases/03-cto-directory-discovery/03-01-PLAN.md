# Plan 03-01: Create CTO Directory Page

**Phase:** 3 - CTO Directory and Discovery
**Objective:** Build a public directory page listing all CTOs with their profiles
**Requirements:** DIR-01, DIR-02

## Context

Students need a way to discover CTOs available for advisory sessions. This requires:
1. A public directory page at `/org/[orgSlug]/directory`
2. Display CTO cards with photo, name, bio, expertise
3. Links to individual CTO booking pages

## Technical Approach

Based on Cal.com codebase research:
- Use Next.js App Router: `/apps/web/app/(booking-page-wrapper)/org/[orgSlug]/directory/page.tsx`
- Data fetching: `getTeamWithMembers` from `packages/features/ee/teams/lib/queries.ts`
- Reuse components: `UserAvatar` from `@calcom/ui/components/avatar`
- Reference: `/apps/web/components/team/screens/Team.tsx`

## Prerequisites

- Organization created with CTOs as members
- CTOs have profiles with bio and photo

## Tasks

### Task 1: Create Directory Page Component

Create `/apps/web/app/(booking-page-wrapper)/org/[orgSlug]/directory/page.tsx`:

```tsx
import { getTeamWithMembers } from "@calcom/features/ee/teams/lib/queries";
import { UserAvatar } from "@calcom/ui/components/avatar";
import Link from "next/link";
import { notFound } from "next/navigation";

interface DirectoryPageProps {
  params: { orgSlug: string };
}

export default async function DirectoryPage({ params }: DirectoryPageProps) {
  const org = await getTeamWithMembers({
    slug: params.orgSlug,
    isOrgView: true,
  });

  if (!org) {
    notFound();
  }

  const members = org.members || [];

  return (
    <div className="mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8">
      <div className="text-center mb-12">
        <h1 className="text-3xl font-bold text-gray-900">
          Meet Our CTOs
        </h1>
        <p className="mt-4 text-lg text-gray-600">
          Book advisory sessions with experienced tech leaders
        </p>
      </div>

      <div className="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {members.map((member) => (
          <CTOCard key={member.id} member={member} orgSlug={params.orgSlug} />
        ))}
      </div>
    </div>
  );
}

function CTOCard({ member, orgSlug }) {
  return (
    <Link
      href={`/${member.username}`}
      className="block rounded-lg border border-gray-200 bg-white p-6 shadow-sm hover:shadow-md transition-shadow"
    >
      <div className="flex flex-col items-center text-center">
        <UserAvatar
          size="lg"
          user={member}
          className="h-24 w-24 mb-4"
        />
        <h3 className="text-lg font-semibold text-gray-900">
          {member.name}
        </h3>
        {member.bio && (
          <p className="mt-2 text-sm text-gray-600 line-clamp-3">
            {member.bio}
          </p>
        )}
        <span className="mt-4 text-sm font-medium text-brand">
          Book a session â†’
        </span>
      </div>
    </Link>
  );
}
```

### Task 2: Add Metadata for SEO

Add metadata export:

```tsx
export async function generateMetadata({ params }: DirectoryPageProps) {
  const org = await getTeamWithMembers({
    slug: params.orgSlug,
    isOrgView: true,
  });

  return {
    title: `CTO Directory | ${org?.name || "RainCal"}`,
    description: "Browse and book advisory sessions with experienced CTOs",
  };
}
```

### Task 3: Handle Loading States

Create loading.tsx for skeleton UI:

```tsx
// /apps/web/app/(booking-page-wrapper)/org/[orgSlug]/directory/loading.tsx
export default function Loading() {
  return (
    <div className="mx-auto max-w-7xl px-4 py-8">
      <div className="animate-pulse">
        <div className="h-8 bg-gray-200 rounded w-1/3 mx-auto mb-4" />
        <div className="h-4 bg-gray-200 rounded w-1/2 mx-auto mb-12" />
        <div className="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
          {[1, 2, 3, 4, 5, 6].map((i) => (
            <div key={i} className="h-64 bg-gray-200 rounded-lg" />
          ))}
        </div>
      </div>
    </div>
  );
}
```

### Task 4: Test Directory Page

1. Create test organization with CTOs
2. Navigate to `/org/[orgSlug]/directory`
3. Verify CTO cards display correctly
4. Verify links to individual booking pages work

## Verification

- [ ] Directory page renders at `/org/[orgSlug]/directory`
- [ ] CTO cards show photo, name, bio
- [ ] Cards link to CTO booking pages
- [ ] Page has proper metadata for SEO
- [ ] Loading state displays skeleton UI
- [ ] Handles non-existent organization (404)

## Notes

- May need to adjust data fetching based on actual API availability
- Consider caching strategy for production
- Bio field may need to be added to user profiles if not present
