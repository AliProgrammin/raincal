# Plan 03-03: Add Search and Filter to Directory

**Phase:** 3 - CTO Directory and Discovery
**Objective:** Enable students to search/filter CTOs by expertise or name
**Requirements:** DIR-03 (Search by expertise)

## Context

With many CTOs, students need to find relevant advisors:
- Search by name
- Filter by expertise area
- Sort by availability

## Prerequisites

- Directory page created (Plan 03-01)
- CTO profiles enhanced (Plan 03-02)

## Tasks

### Task 1: Add Search Input

Add client-side search to directory page:

```tsx
"use client";

import { useState } from "react";

function DirectorySearch({ onSearch }) {
  const [query, setQuery] = useState("");

  return (
    <div className="mb-8">
      <input
        type="text"
        placeholder="Search CTOs by name or expertise..."
        value={query}
        onChange={(e) => {
          setQuery(e.target.value);
          onSearch(e.target.value);
        }}
        className="w-full max-w-md mx-auto block rounded-lg border border-gray-300 px-4 py-2"
      />
    </div>
  );
}
```

### Task 2: Add Expertise Filter Tags

Create filter chips for common expertise areas:

```tsx
const EXPERTISE_FILTERS = [
  "Cloud & Infrastructure",
  "AI & Machine Learning",
  "Mobile Development",
  "Web Development",
  "Data Engineering",
  "DevOps",
  "Product Strategy",
  "Startup Growth",
];

function ExpertiseFilters({ selected, onSelect }) {
  return (
    <div className="flex flex-wrap gap-2 justify-center mb-8">
      {EXPERTISE_FILTERS.map((expertise) => (
        <button
          key={expertise}
          onClick={() => onSelect(expertise)}
          className={`px-3 py-1 rounded-full text-sm ${
            selected.includes(expertise)
              ? "bg-brand text-white"
              : "bg-gray-100 text-gray-700 hover:bg-gray-200"
          }`}
        >
          {expertise}
        </button>
      ))}
    </div>
  );
}
```

### Task 3: Implement Filter Logic

Filter members based on search and expertise:

```tsx
function filterMembers(members, searchQuery, expertiseFilters) {
  return members.filter((member) => {
    // Search by name or bio
    const matchesSearch = !searchQuery ||
      member.name?.toLowerCase().includes(searchQuery.toLowerCase()) ||
      member.bio?.toLowerCase().includes(searchQuery.toLowerCase());

    // Filter by expertise
    const matchesExpertise = expertiseFilters.length === 0 ||
      expertiseFilters.some((exp) =>
        member.expertise?.includes(exp)
      );

    return matchesSearch && matchesExpertise;
  });
}
```

### Task 4: Update Directory Page

Convert to client component with filtering:

```tsx
"use client";

import { useState } from "react";

export default function DirectoryClient({ members, orgSlug }) {
  const [searchQuery, setSearchQuery] = useState("");
  const [expertiseFilters, setExpertiseFilters] = useState([]);

  const filteredMembers = filterMembers(
    members,
    searchQuery,
    expertiseFilters
  );

  return (
    <>
      <DirectorySearch onSearch={setSearchQuery} />
      <ExpertiseFilters
        selected={expertiseFilters}
        onSelect={(exp) => {
          setExpertiseFilters((prev) =>
            prev.includes(exp)
              ? prev.filter((e) => e !== exp)
              : [...prev, exp]
          );
        }}
      />
      <div className="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {filteredMembers.map((member) => (
          <CTOCard key={member.id} member={member} orgSlug={orgSlug} />
        ))}
        {filteredMembers.length === 0 && (
          <p className="col-span-full text-center text-gray-500">
            No CTOs found matching your criteria
          </p>
        )}
      </div>
    </>
  );
}
```

### Task 5: Server/Client Component Split

Split into server and client components:

```
/org/[orgSlug]/directory/
  page.tsx         - Server component (data fetching)
  DirectoryClient.tsx - Client component (search/filter)
```

### Task 6: Test Search and Filter

1. Add multiple CTOs with different expertise
2. Test search by name
3. Test search by keywords in bio
4. Test expertise filter selection
5. Test multiple filter combination
6. Verify "No results" state

## Verification

- [ ] Search input filters CTOs by name
- [ ] Search filters by bio content
- [ ] Expertise filter chips work
- [ ] Multiple filters can be combined
- [ ] Clear filters shows all CTOs
- [ ] Empty state shown when no matches

## Notes

- Start with client-side filtering for simplicity
- Can add server-side search later if needed for scale
- Expertise tags depend on CTO profile data
